# Store the list of currently staged files
STAGED_FILES=$(git diff --cached --name-only)

# Run formatters and linter fixes on staged files only
if [ -n "$STAGED_FILES" ]; then
    echo "$STAGED_FILES" | xargs npx prettier --write --ignore-unknown
    echo "$STAGED_FILES" | grep -E '\.(js|jsx|ts|tsx)$' | xargs -r npx eslint --fix
    echo "$STAGED_FILES" | xargs git add
fi

# Run final checks
npm run lint && \
npm run build
